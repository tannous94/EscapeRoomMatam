This is an implementation in C
